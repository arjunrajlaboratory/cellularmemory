bp <- ggplot(data = test, aes(x=condition,y=tpm))+
geom_boxplot(aes(fill=condition),alpha=0.7, outlier.shape = NA)+
ylab('reads in tpm')+
ggtitle(geneName)
# Generate file path dynamically based on gene name
filePath <- paste0("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/", geneName, ".png")
png(filePath,    # File name
width = 400, height = 300, # Width and height in pixels
bg = "white"
)
print(bp + scale_fill_manual(values=c("#707071", "#F2EDA5", "#005F6A")))
dev.off()
}
# Loop through each gene name
for(geneName in geneNames) {
test <- filter(data, gene_name == geneName)
test$condition <- factor(test$condition, levels = c("non-primed", "primed", "PLX-resistant"))
bp <- ggplot(data = test, aes(x=condition,y=tpm))+
geom_boxplot(aes(fill=condition),alpha=0.7, outlier.shape = NA)+
ylab('reads in tpm')+
ggtitle(geneName)
# Generate file path dynamically based on gene name
filePath <- paste0("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/", geneName, ".png")
png(filePath,    # File name
width = 4000, height = 3000, # Width and height in pixels
bg = "white"
)
print(bp + scale_fill_manual(values=c("#707071", "#F2EDA5", "#005F6A")))
dev.off()
}
# Loop through each gene name
for(geneName in geneNames) {
test <- filter(data, gene_name == geneName)
test$condition <- factor(test$condition, levels = c("non-primed", "primed", "PLX-resistant"))
bp <- ggplot(data = test, aes(x=condition,y=tpm))+
geom_boxplot(aes(fill=condition),alpha=0.7, outlier.shape = NA)+
ylab('reads in tpm')+
ggtitle(geneName)
# Generate file path dynamically based on gene name
filePath <- paste0("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/", geneName, ".png")
png(filePath,    # File name
width = 1000, height = 1000, # Width and height in pixels
bg = "white"
)
print(bp + scale_fill_manual(values=c("#707071", "#F2EDA5", "#005F6A")))
dev.off()
}
# Loop through each gene name
for(geneName in geneNames) {
test <- filter(data, gene_name == geneName)
test$condition <- factor(test$condition, levels = c("non-primed", "primed", "PLX-resistant"))
bp <- ggplot(data = test, aes(x=condition,y=tpm))+
geom_boxplot(aes(fill=condition),alpha=0.7, outlier.shape = NA)+
ylab('reads in tpm')+
theme_minimal()+
ggtitle(geneName)
# Generate file path dynamically based on gene name
filePath <- paste0("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/", geneName, ".png")
png(filePath,    # File name
width = 3000, height = 3000, # Width and height in pixels
bg = "white"
)
print(bp + scale_fill_manual(values=c("#707071", "#F2EDA5", "#005F6A")))
dev.off()
}
# Loop through each gene name
for(geneName in geneNames) {
test <- filter(data, gene_name == geneName)
test$condition <- factor(test$condition, levels = c("non-primed", "primed", "PLX-resistant"))
bp <- ggplot(data = test, aes(x=condition,y=tpm))+
geom_boxplot(aes(fill=condition),alpha=0.7, outlier.shape = NA)+
ylab('reads in tpm')+
theme_minimal()+
ggtitle(geneName)
# Generate file path dynamically based on gene name
filePath <- paste0("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/", geneName, ".pdf")
pdf(filePath,    # File name
width = 6, height = 6, # Width and height in inches
bg = "white"
)
print(bp + scale_fill_manual(values=c("#707071", "#F2EDA5", "#005F6A")))
dev.off()
}
# Loop through each gene name
for(geneName in geneNames) {
test <- filter(data, gene_name == geneName)
test$condition <- factor(test$condition, levels = c("non-primed", "primed", "PLX-resistant"))
bp <- ggplot(data = test, aes(x=condition,y=tpm))+
geom_boxplot(aes(fill=condition),alpha=0.7, outlier.shape = NA)+
ylab('reads in tpm')+
theme_minimal()+
ggtitle(geneName)
# Generate file path dynamically based on gene name
filePath <- paste0("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/", geneName, ".pdf")
pdf(filePath,    # File name
width = 6, height = 6, # Width and height in inches
bg = "white"
)
print(bp + scale_fill_manual(values=c("#707071", '#ECAB21', "sienna")))
dev.off()
}
# Loop through each gene name
for(geneName in geneNames) {
test <- filter(data, gene_name == geneName)
test$condition <- factor(test$condition, levels = c("non-primed", "primed", "PLX-resistant"))
bp <- ggplot(data = test, aes(x=condition,y=tpm))+
geom_boxplot(aes(fill=condition),alpha=0.7, outlier.shape = NA)+
ylab('reads in tpm')+
theme_minimal()+
ggtitle(geneName)
# Generate file path dynamically based on gene name
filePath <- paste0("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/", geneName, ".pdf")
pdf(filePath,    # File name
width = 6, height = 6, # Width and height in inches
bg = "white"
)
print(bp + scale_fill_manual(values=c("#707071", '#ECAB21', "#C24B1C")))
dev.off()
}
# Loop through each gene name
for(geneName in geneNames) {
test <- filter(data, gene_name == geneName)
test$condition <- factor(test$condition, levels = c("non-primed", "primed", "PLX-resistant"))
bp <- ggplot(data = test, aes(x=condition,y=tpm))+
geom_boxplot(aes(fill=condition),alpha=0.7, outlier.shape = NA)+
ylab('reads in tpm')+
theme_minimal()+
ggtitle(geneName)
# Generate file path dynamically based on gene name
filePath <- paste0("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/", geneName, ".pdf")
pdf(filePath,    # File name
width = 6, height = 6, # Width and height in inches
bg = "white"
)
print(bp + scale_fill_manual(values=c("#707071", '#ECAB21', "#C23B1C")))
dev.off()
}
# create heatmap
pheatmap(orderedMatrixKeep, cutree_rows = 5, cluster_cols=F,  color=colorRampPalette(c("grey", "#ECAB21", "#C23B1C","#C23B1C"))(100))
# customizing pdf output
pdf("/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/primedcellrnaseq_heatmap.pdf",         # File name
width = 8, height = 18, # Width and height in inches
bg = "white"
)
# create heatmap
pheatmap(orderedMatrixKeep, cutree_rows = 5, cluster_cols=F,  color=colorRampPalette(c("grey", "#ECAB21", "#C23B1C","#C23B1C"))(100))
# customizing pdf output
pdf("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/primedcellrnaseq_heatmap.pdf",         # File name
width = 8, height = 18, # Width and height in inches
bg = "white"
)
# create heatmap
pheatmap(orderedMatrixKeep, cutree_rows = 5, cluster_cols=F,  color=colorRampPalette(c("grey", "#ECAB21", "#C23B1C","#C23B1C"))(100))
dev.off()
View(orderedMatrix)
genes_to_remove <- grep("\\.", rownames(orderedMatrixKeep))
genes_to_remove <- grep("\\.", rownames(orderedMatrixKeep))
orderedMatrixKeep <- orderedMatrixKeep[-genes_to_remove,]
# customizing pdf output
pdf("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/primedcellrnaseq_heatmap.pdf",         # File name
width = 8, height = 18, # Width and height in inches
bg = "white"
)
# create heatmap
pheatmap(orderedMatrixKeep, cutree_rows = 5, cluster_cols=F,  color=colorRampPalette(c("grey", "#ECAB21", "#C23B1C","#C23B1C"))(100))
dev.off()
# customizing pdf output
pdf("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/primedcellrnaseq/primedcellrnaseq_heatmap.pdf",         # File name
width = 8, height = 16, # Width and height in inches
bg = "white"
)
# create heatmap
pheatmap(orderedMatrixKeep, cutree_rows = 5, cluster_cols=F,  color=colorRampPalette(c("grey", "#ECAB21", "#C23B1C","#C23B1C"))(100))
dev.off()
library(dplyr)
library(ggplot2)
library(pheatmap)
library(tidyr)
library(GenomicFeatures)
library(rtracklayer)
library(viridis)
input_directory <- "/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/burninrnaseq/202208"
output_dir <- "/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/burninrnaseq/202208"
data <- read.table(file.path(input_directory, "log2CPM.txt"), header = TRUE, sep = "\t")
dataCPM <- read.table(file.path(input_directory, "UnLOG2CPM.txt"), header = TRUE, sep = "\t")
targets <- read.table(file.path(input_directory,'studydesign.tsv'), header = TRUE, sep = "\t")
dataCPM <- left_join(dataCPM, targets, by = "samples")
dataCPM <- dataCPM[,c(1:3,5:12)]
data <- left_join(data, targets, by = "samples")
data <- data[,c(1:3,5:11)]
dataCPM$treatment <- factor(dataCPM$treatment,levels = c("DMSO","dexamethasone","compound C","AICAR","PMA","trametinib","dex+tram","cmpdC+tram","AICAR+tram","PMA+tram","tram+JNKIN8", "dex+tram+JNKIN8","cmpdC+tram+JNKIN8","AICAR+tram+JNKIN8","PMA+tram+JNKIN8", "tram+T5224", "dex+tram+T5224","cmpdC+tram+T5224","AICAR+tram+T5224","PMA+tram+T5224"))
data$treatment <- factor(data$treatment,levels = c("DMSO","dexamethasone","compound C","AICAR","PMA","trametinib","dex+tram","cmpdC+tram","AICAR+tram","PMA+tram","tram+JNKIN8", "dex+tram+JNKIN8","cmpdC+tram+JNKIN8","AICAR+tram+JNKIN8","PMA+tram+JNKIN8", "tram+T5224", "dex+tram+T5224","cmpdC+tram+T5224","AICAR+tram+T5224","PMA+tram+T5224"))
#### isolate dex data
dexCPMData <- dplyr::filter(dataCPM, group.x == "dexamethasone")
dexData <- dplyr::filter(data, group.x == "dexamethasone")
hg19_GTF <- file.path(input_directory, "Homo_sapiens.GRCh38.107.gtf")
GTF <- readGFF(hg19_GTF)
#### graph for one gene
gene = "FKBP5"
graphData <- dplyr::filter(dexCPMData, geneID == gene & condition.y %in% c("DMSO_1","Dex","pre_Dex","pre_DMSO_1","T_1","pre_T_1","pre_T_8_1","pre_T_5224_1"))
graphData$condition.y <- factor(graphData$condition.y,levels = c("DMSO_1","Dex","pre_Dex","pre_DMSO_1","T_1","pre_T_1","pre_T_8_1","pre_T_5224_1"))
ggplot(data = graphData, aes(x=condition.y, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=treatment.x),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
ggplot(data = graphData, aes(x=condition.y, y=unLog2Expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=treatment.x),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('CPM')
samplesAbv <- c("Sample_1", "Sample_2", "Sample_3", #dmso (1-3)
"Sample_4", "Sample_5", "Sample_6", #dex (4-6)
"Sample_13", "Sample_14", "Sample_15", #dexOff (7-9)
"Sample_7", "Sample_8", "Sample_9", #trametinib (10-12)
"Sample_19", "Sample_20", "Sample_21", #burnIn (13-15)
"Sample_37", "Sample_38", "Sample_39"  #pre+JNK8+T
,"Sample_43", "Sample_44", "Sample_45" #pre+T5224+T
)
geneVarSamples <- c("Sample_1", "Sample_2", "Sample_3", #dmso (1-3)
"Sample_4", "Sample_5", "Sample_6", #dmso --> dex (4-6)
"Sample_13", "Sample_14", "Sample_15", #dex --> dmso
"Sample_16","Sample_17","Sample_18") #dex
geneVarData <- dexCPMData[,c(1:3,10)]
geneVarData <- dplyr::filter(geneVarData, samples %in% geneVarSamples)
gene_id_to_biotype <- GTF[-which(duplicated(GTF$gene_id)),c(9,11,12,13)]
geneVarData <- left_join(geneVarData, gene_id_to_biotype, by=c('geneID'='gene_name'))
geneVar <- dplyr::filter(geneVarData, gene_biotype=='protein_coding')
geneVar <- geneVar %>% group_by(geneID, samples) %>% summarise(cpm = mean(unLog2Expression))
geneVarMatrix <- geneVar[,c(1:3)]
geneVarMatrix <- spread(geneVarMatrix,samples,cpm)
rownamesGeneVar <- geneVarMatrix$geneID
geneVarMatrix <- dplyr::mutate(geneVarMatrix, dmso14d = (Sample_1 + Sample_2 + Sample_3)/3)
geneVarMatrix <- dplyr::mutate(geneVarMatrix, dex11d = (Sample_4 + Sample_5 + Sample_6)/3)
geneVarMatrix <- dplyr::mutate(geneVarMatrix, dexOff = (Sample_13 + Sample_14 + Sample_15)/3)
geneVarMatrix <- dplyr::mutate(geneVarMatrix, dex14d = (Sample_16 + Sample_17 + Sample_18)/3)
geneVarMatrix <- dplyr::mutate(geneVarMatrix, dexFC = log((dex14d/dmso14d),2))
write.table(geneVarMatrix, file = file.path(output_dir, "geneVarMatrix.csv"), row.names = F, col.names = T, quote = T, sep =",")
geneVarList <- geneVarMatrix %>% dplyr::filter(abs(dexFC) > 4.2)
geneVarLog <- geneVarData %>% group_by(geneID, samples) %>% summarise(Log2cpm = mean(expression))
geneVarLogMatrix <- spread(geneVarLog,samples,Log2cpm)
geneVarLogMatrix <- dplyr::filter(geneVarLogMatrix, geneID %in% geneVarList$geneID)
rownamesGeneVarLog <- geneVarLogMatrix$geneID
gvlm <- geneVarLogMatrix[,c(2,9,10,6,7,8,3,4,5)]
gvlm <- data.matrix(gvlm)
rownames(gvlm) = rownamesGeneVarLog
pheatmap(gvlm, cutree_rows = 5, cluster_cols=F, color=colorRampPalette(c("#2166AC", "#F7F7F7", "#B2182B"))(50))
forMatrix <- dexCPMData[,c(1:3)]
forMatrix <- dplyr::filter(forMatrix, samples %in% samplesAbv)
forMatrix <- dplyr::filter(forMatrix, geneID %in% geneVarList$geneID)
forMatrix <- spread(forMatrix,samples,expression)
rownames <- forMatrix$geneID
forMatrix <- forMatrix[, c(2,7,10,14,18,19,3:5,20:22,6,8,9,11:13)]
forMatrix <- data.matrix(forMatrix)
rownames(forMatrix) = rownames
pheatmap(forMatrix, cutree_rows = 4, cluster_cols=F, color=viridis(250))
View(dataCPM)
ggplot(data = geneVarData, aes(x=condition.y, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=treatment.x),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
View(geneVarData)
ggplot(data = geneVarData, aes(x=condition.y, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=samples),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
ggplot(data = geneVarData, aes(x=samples, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=samples),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
gene = "FKBP5"
gene = "FKBP5"
graphData <- dplyr::filter(geneVarData, geneID == gene)
ggplot(data = graphData, aes(x=samples, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=samples),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
View(dexCPMData)
geneVarData <- dexCPMData[,c(1:3,9-10)]
geneVarData <- dexCPMData[,c(1:3,9:10)]
geneVarData <- dplyr::filter(geneVarData, samples %in% geneVarSamples)
gene = "FKBP5"
graphData <- dplyr::filter(geneVarData, geneID == gene)
geneVarData <- dexCPMData[,c(1:3,10:11)]
geneVarData <- dplyr::filter(geneVarData, samples %in% geneVarSamples)
gene = "FKBP5"
graphData <- dplyr::filter(geneVarData, geneID == gene)
ggplot(data = graphData, aes(x=condition.y, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=condition.y),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
View(geneVarData)
graphData <- dplyr::filter(dexCPMData, geneID == gene & condition.y %in% c("DMSO_1","Dex","pre_Dex","pre_DMSO_1","T_1","pre_T_1","pre_T_8_1","pre_T_5224_1"))
graphData$condition.y <- factor(graphData$condition.y,levels = c("DMSO_1","Dex","pre_Dex","pre_DMSO_1","T_1","pre_T_1","pre_T_8_1","pre_T_5224_1"))
ggplot(data = graphData, aes(x=condition.y, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=treatment.x),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
graphData <- dplyr::filter(dexCPMData, geneID == gene & condition.y %in% c("DMSO_1","Dex",
#"pre_Dex",
"pre_DMSO_1","T_1","pre_T_1","pre_T_8_1"
#,"pre_T_5224_1"
))
graphData$condition.y <- factor(graphData$condition.y,levels = c("DMSO_1","Dex","pre_Dex","pre_DMSO_1","T_1","pre_T_1","pre_T_8_1","pre_T_5224_1"))
ggplot(data = graphData, aes(x=condition.y, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=treatment.x),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
genelist = "TGM2"
graphData <- dplyr::filter(dexCPMData, geneID == gene & condition.y %in% c("DMSO_1","Dex",
#"pre_Dex",
"pre_DMSO_1","T_1","pre_T_1","pre_T_8_1"
#,"pre_T_5224_1"
))
graphData$condition.y <- factor(graphData$condition.y,levels = c("DMSO_1","Dex","pre_Dex","pre_DMSO_1","T_1","pre_T_1","pre_T_8_1","pre_T_5224_1"))
ggplot(data = graphData, aes(x=condition.y, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=treatment.x),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
gene = "TGM2"
graphData <- dplyr::filter(dexCPMData, geneID == gene & condition.y %in% c("DMSO_1","Dex",
#"pre_Dex",
"pre_DMSO_1","T_1","pre_T_1","pre_T_8_1"
#,"pre_T_5224_1"
))
graphData$condition.y <- factor(graphData$condition.y,levels = c("DMSO_1","Dex","pre_Dex","pre_DMSO_1","T_1","pre_T_1","pre_T_8_1","pre_T_5224_1"))
ggplot(data = graphData, aes(x=condition.y, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=treatment.x),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
gene = "LTBP1"
graphData <- dplyr::filter(dexCPMData, geneID == gene & condition.y %in% c("DMSO_1","Dex",
#"pre_Dex",
"pre_DMSO_1","T_1","pre_T_1","pre_T_8_1"
#,"pre_T_5224_1"
))
graphData$condition.y <- factor(graphData$condition.y,levels = c("DMSO_1","Dex","pre_Dex","pre_DMSO_1","T_1","pre_T_1","pre_T_8_1","pre_T_5224_1"))
ggplot(data = graphData, aes(x=condition.y, y=expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=treatment.x),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('log2 CPM')
ggplot(data = graphData, aes(x=condition.y, y=unLog2Expression))+
ggtitle(gene)+
geom_boxplot(aes(fill=treatment.x),alpha=0.2, outlier.shape = NA)+
geom_jitter(color="black", size= 1, alpha=0.9)+
theme_bw()+ylab('CPM')
source("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plotScripts/dexmemfish/combinefunction.R")
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
warnings()
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5"
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary"
#"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
library(ggplot2)
library(dplyr)
library(tidyr)
# Function to safely convert to numeric
convert_to_numeric <- function(df, cols_to_convert) {
existing_cols <- intersect(cols_to_convert, names(df))
df[existing_cols] <- lapply(df[existing_cols], function(x) as.numeric(as.character(x)))
return(df)
}
# Function to process and plot data from multiple input directories
process_and_plot_data_from_multiple_dirs <- function(inputdirectories, outputdirectory) {
# Columns to convert
cols_to_convert <- c("cy3", "a594", "cy5", "cy7","cell.Blob.Blob.metrics...Area","cell.Blob.Blob.metrics...Perimeter","cell.Blob.Blob.metrics...Centroid...y","cell.Blob.Blob.metrics...Centroid...x")
# Function to extract identifier from filename
extract_identifier <- function(filename) {
# Extracting everything after the last "-" and before the ".csv"
sub(".*-(.*)\\.csv$", "\\1", basename(filename))
}
# Initialize an empty list to store data from all directories
all_data_list <- list()
# Iterate over each input directory and append data
for(inputdirectory in inputdirectories) {
files <- list.files(path = inputdirectory, pattern = "*.csv", full.names = TRUE)
data_list <- lapply(files, function(f) {
df <- read.csv(f, stringsAsFactors = FALSE)
df <- convert_to_numeric(df, cols_to_convert)
df$file_identifier <- extract_identifier(f) # Adding the identifier
return(df)
})
all_data_list <- c(all_data_list, data_list) # Append data from current directory
}
# Combining all data into one dataframe
all_data <- bind_rows(all_data_list, .id = "file_id")
# Follow the existing steps to process the combined data and generate plots...
# The rest of the code remains unchanged from the given script
# Ensure to replace all occurrences of `data_list` with `all_data_list` in the original code where appropriate
# Save the plots and output as before
}
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6"
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
inputdirectories <- ("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
inputdirectories <- ("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
inputdirectories <- c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6"
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
#"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
)
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
source("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plotScripts/dexmemfish/combinefunction.R")
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
source("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plotScripts/dexmemfish/combinefunction.R")
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
process_and_plot_data_from_multiple_dirs(c("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep1",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep2",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep3/primary",
"/Users/jessi/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep4",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep5",
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep6"
# "/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep7",
# "/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/dexmemfish/rep8/primary"
),
"/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/plots/dexmemfish")
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(readr)
load("/Users/jess/Dropbox (RajLab)/Shared_JessL/paper/extractedData/10xfatemap/v3.RData")
